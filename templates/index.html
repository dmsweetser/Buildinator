<!DOCTYPE html>
<html>
  <head>
    <title>Buildinator</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  </head>
  <body>
    <h1>Buildinator</h1>
    <div class="accordion" id="accordionExample">
      {% for app in apps %}
        <div class="card">
          <div class="card-header" id="heading{{ app.id }}">
            <h2 class="mb-0">
              <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse{{ app.id }}" aria-expanded="true" aria-controls="collapse{{ app.id }}">
                {{ app.name }}
              </button>
            </h2>
          </div>
          <div id="collapse{{ app.id }}" class="collapse show" aria-labelledby="heading{{ app.id }}" data-parent="#accordionExample">
            <div class="card-body">
              <p>Prompt: {{ app.prompt }}</p>
              <p>Input Code: {{ app.input_code }}</p>
              <p>Language: {{ app.language }}</p>
              <p>Is Queued: {{ "Yes" if app.is_queued else "No" }}</p>
              <a href="/delete_app/{{ app.id }}">Delete App</a>
              <a href="/remove_from_queue/{{ app.id }}">Remove from Queue</a>
              <ul>
              {% for iteration in app.iterations %}
                <li>
                  <p>Iteration {{ iteration.id }}</p>
                  <p>Output Code: <img src="/download_iteration/{{ iteration.id }}"></p>
                  <p>Build Output: {{ iteration.build_output }}</p>
                  <a href="/delete_iteration/{{ iteration.id }}">Delete Iteration</a>
                </li>
              {% endfor %}
              </ul>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
    <form action="/build" method="post">
      <label for="app_name">App Name:</label>
      <input type="text" id="app_name" name="app_name"><br><br>
      <label for="prompt">Prompt:</label>
      <textarea id="prompt" name="prompt"></textarea><br><br>
      <label for="language">Language:</label>
      <select id="language" name="language">
        <option value="py">Python</option>
        <option value="cs">C#/.NET</option>
      </select><br><br>
      <label for="input_code">Input Code:</label>
      <textarea id="input_code" name="input_code"></textarea><br><br>
      <input type="submit" value="Build">
    </form>
    <script>
      $(document).ready(function() {
        setInterval(function() {
          location.reload();
        }, 10000);
      });
    </script>
  </body>
</html>
